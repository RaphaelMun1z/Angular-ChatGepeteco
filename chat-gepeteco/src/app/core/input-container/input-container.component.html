<div class="bg-gray-100 dark:bg-[#1e1f20] hover:bg-gray-200 dark:hover:bg-[#2b2c2d] transition-colors rounded-[28px] p-5 flex flex-col justify-between cursor-text mb-8 relative group">
    
    <textarea 
        [(ngModel)]="userInput"
        (keydown)="handleEnter($event)"
        rows="1" 
        placeholder="Pergunte ao Gepeteco" 
        class="w-full bg-transparent border-none focus:ring-0 text-gray-900 dark:text-[#e3e3e3] placeholder-gray-500 dark:placeholder-[#c4c7c5]/70 text-lg resize-none max-h-64 overflow-y-auto focus:outline-none mt-1 ml-1 font-normal scrollbar-hide"
    ></textarea>
    
    <div class="flex items-center justify-between mt-4 relative">
        
        <div class="flex items-center gap-2 relative">
            
            <div class="relative">
                <button (click)="togglePlusPopup()" 
                        class="w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-300/50 dark:hover:bg-white/10 transition-colors"
                        [ngClass]="{'bg-gray-300/50 dark:bg-white/10 text-gray-900 dark:text-white': isPlusPopupOpen}">
                    <i class="fa-solid fa-plus text-gray-700 dark:text-[#e3e3e3] transition-transform duration-200"
                       [ngClass]="{'rotate-45': isPlusPopupOpen}"></i>
                </button>
                
                <div *ngIf="isPlusPopupOpen" 
                     class="absolute bottom-full left-0 mb-2 w-56 bg-white dark:bg-[#2b2c2d] border border-gray-200 dark:border-[#444746] rounded-xl shadow-2xl overflow-hidden z-20 flex flex-col p-1">
                    
                    <label class="flex items-center gap-3 w-full px-3 py-3 hover:bg-gray-100 dark:hover:bg-[#333537] rounded-lg text-left transition-colors cursor-pointer">
                        <div class="w-8 h-8 rounded-full bg-gray-200 dark:bg-[#333537] flex items-center justify-center border border-gray-300 dark:border-[#444746]">
                            <i class="fa-solid fa-file-pdf text-gray-700 dark:text-[#e3e3e3]"></i>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-sm font-medium text-gray-900 dark:text-[#e3e3e3]">Fazer upload</span>
                            <span class="text-xs text-gray-500 dark:text-[#c4c7c5]">Apenas arquivos .pdf</span>
                        </div>
                        <input type="file" accept=".pdf" class="hidden" (change)="handleFileUpload($event)">
                    </label>
                </div>
            </div>
        </div>
        
        <div class="flex items-center gap-3 relative">
            
            <div class="relative">
                <div (click)="toggleModelPopup()" 
                     class="flex items-center gap-1.5 text-gray-600 dark:text-[#c4c7c5] text-[0.8rem] font-medium cursor-pointer hover:text-gray-900 dark:hover:text-white transition-colors py-2 px-3 rounded-lg hover:bg-gray-200 dark:hover:bg-white/5 select-none">
                    {{ selectedModel.name }} 
                    <i class="fa-solid fa-chevron-down text-[10px] transition-transform duration-200"
                       [ngClass]="{'rotate-180': isModelPopupOpen}"></i>
                </div>
                
                <div *ngIf="isModelPopupOpen" 
                     class="absolute bottom-full right-0 mb-2 w-64 bg-white dark:bg-[#2b2c2d] rounded-xl shadow-2xl overflow-hidden z-20 flex flex-col p-1 border border-gray-200 dark:border-[#444746]">
                    
                    <div class="px-3 py-2 text-xs text-gray-500 dark:text-[#c4c7c5] font-bold uppercase tracking-wider">
                        Modelos Dispon√≠veis
                    </div>
                    
                    <button *ngFor="let model of availableModels"
                            (click)="selectModel(model)"
                            class="flex items-center gap-3 w-full px-3 py-3 rounded-lg text-left transition-colors"
                            [ngClass]="selectedModel.id === model.id ? 'bg-gray-200 dark:bg-[#333537]' : 'hover:bg-gray-200 dark:hover:bg-[#333537]'">
                        
                        <i class="fa-solid text-lg w-5 text-center" 
                           [ngClass]="[model.icon, model.iconColor]"></i>
                        
                        <div class="flex flex-col">
                            <span class="text-sm font-medium" 
                                  [ngClass]="selectedModel.id === model.id ? 'text-gray-900 dark:text-white' : 'text-gray-800 dark:text-[#e3e3e3]'">
                                {{ model.name }}
                            </span>
                            <span class="text-xs text-gray-500 dark:text-[#c4c7c5]">{{ model.description }}</span>
                        </div>

                        <i *ngIf="selectedModel.id === model.id" 
                           class="fa-solid fa-check text-blue-500 dark:text-[#a8c7fa] ml-auto text-sm"></i>
                    </button>
                </div>
            </div>

            <button (click)="send()" 
                    [disabled]="!userInput.trim()"
                    class="w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200"
                    [ngClass]="userInput.trim() ? 'bg-black text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-[#e3e3e3]' : 'bg-transparent text-transparent cursor-default'">
                <i class="fa-solid fa-paper-plane text-sm" [ngClass]="{'opacity-0': !userInput.trim()}"></i>
            </button>

        </div>
    </div>
</div>
